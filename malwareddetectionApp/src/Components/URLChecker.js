import React, { useState } from "react";
import { View, TextInput, Button, Text } from "react-native";
import axios from "axios";
import { API_KEYS } from "../APIConfig";

const URLChecker = () => {
    const [url, setUrl] = useState("");
    const [result, setResult] = useState("");

    const checkURL = async () => {
        try {
            const response = await axios.post(
                `https://safebrowsing.googleapis.com/v4/threatMatches:find?key=${API_KEYS.GOOGLE_SAFE_BROWSING}`,
                {
                    client: { clientId: "malware-detector", clientVersion: "1.0" },
                    threatInfo: {
                        threatTypes: ["MALWARE", "SOCIAL_ENGINEERING"],
                        platformTypes: ["ANY_PLATFORM"],
                        threatEntryTypes: ["URL"],
                        threatEntries: [{ url }]
                    }
                }
            );

            setResult(response.data.matches ? "⚠️ Malicious URL" : "✅ Safe URL");
        } catch (error) {
            setResult("Error checking URL");
        }
    };

    return (
        <View>
            <TextInput placeholder="Enter URL" value={url} onChangeText={setUrl} />
            <Button title="Check URL" onPress={checkURL} />
            <Text>{result}</Text>
        </View>
    );
};

export default URLChecker;
